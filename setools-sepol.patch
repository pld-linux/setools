--- setools-3.3.8/libqpol/src/policy_extend.c.orig	2013-01-16 17:36:24.000000000 +0100
+++ setools-3.3.8/libqpol/src/policy_extend.c	2015-10-26 17:37:22.584888789 +0100
@@ -843,7 +843,7 @@
 			for (class_node = rule->perms; class_node; class_node = class_node->next) {
 				key.rule_type = rule->specified;
 				key.source_val = key.target_val = i + 1;
-				key.class_val = class_node->class;
+				key.class_val = class_node->tclass;
 				key.cond = cond;
 				if (qpol_syn_rule_table_insert_entry(policy, table, &key, new_rule))
 					goto err;
@@ -856,7 +856,7 @@
 				key.rule_type = rule->specified;
 				key.source_val = i + 1;
 				key.target_val = j + 1;
-				key.class_val = class_node->class;
+				key.class_val = class_node->tclass;
 				key.cond = cond;
 				if (qpol_syn_rule_table_insert_entry(policy, table, &key, new_rule))
 					goto err;
--- setools-3.3.8/libqpol/src/policy_define.c.orig	2013-01-16 17:36:24.000000000 +0100
+++ setools-3.3.8/libqpol/src/policy_define.c	2015-10-26 17:43:37.267694311 +0100
@@ -1449,7 +1449,7 @@
 				return -1;
 			}
 			class_perm_node_init(perm);
-			perm->class = i + 1;
+			perm->tclass = i + 1;
 			perm->data = datum->s.value;
 			perm->next = avrule->perms;
 			avrule->perms = perm;
@@ -1699,7 +1699,7 @@
 			goto out;
 		}
 		class_perm_node_init(cur_perms);
-		cur_perms->class = i + 1;
+		cur_perms->tclass = i + 1;
 		if (!perms)
 			perms = cur_perms;
 		if (tail)
--- setools-3.3.8/libqpol/src/syn_rule_query.c.orig	2013-01-16 17:36:24.000000000 +0100
+++ setools-3.3.8/libqpol/src/syn_rule_query.c	2015-10-26 17:46:15.095897256 +0100
@@ -67,7 +67,7 @@
 		return NULL;
 	}
 
-	return db->class_val_to_struct[srcs->cur->class - 1];
+	return db->class_val_to_struct[srcs->cur->tclass - 1];
 }
 
 static int syn_rule_class_state_next(qpol_iterator_t * iter)
@@ -465,10 +465,10 @@
 	}
 
 	for (node = internal_rule->perms; node; node = node->next) {
-		for (i = 0; i < db->class_val_to_struct[node->class - 1]->permissions.nprim; i++) {
+		for (i = 0; i < db->class_val_to_struct[node->tclass - 1]->permissions.nprim; i++) {
 			if (!(node->data & (1 << i)))
 				continue;
-			tmp = sepol_av_to_string(db, node->class, (sepol_access_vector_t) (1 << i));
+			tmp = sepol_av_to_string(db, node->tclass, (sepol_access_vector_t) (1 << i));
 			if (tmp) {
 				tmp++; /* remove prepended space */
 				for (cur = 0; cur < perm_list_sz; cur++)
